# AI

> 출처 : AICE associate 강의를 보고 작성하였습니다.

## 데이터전처리


### 데이터전처리 - 데이터 탐색, 결측치 처리

**데이터 전처리**

수집한 데이터를 분석하고 AI 모델링을 위하여 데이터를 정제하고 다듬는 작업

4가지 방법(**데이터 탐색, 결측치 처리, 이상치 처리, Feature Engineering**)통해 수행.


**데이터 탐색하기**

3가지 방법 이용

1.	**Sample 데이터 확인**

샘플 데이터를 육안으로 확인해 데이터의 구성과 필요 유무 여부 확인

head(), tail()

2.	**통계적 특성 확인**

수치 데이터에 대한 수학적 특성 확인으로 데이터 분포 확인

describe()

3.	**Table 정보 확인**

컬럼 수, 데이터 타입 등을 확인하여 정상적 로드 확인

info()



**데이터 정보 확인**

> DataFrame의 정보를 확인한다 : df.info(
> 
> 육안으로 실제 데이터를 확인한다 : df.head(개수), df.tail(개수) *기본은 5개
> 
> DataFrame의 통계 정보를 확인한다 : df.describe()
> 
> count : 유효 데이터 수
> 
> mean : 평균값
> 
> std : 표준편차
> 
> min : 최소값
> 
> 25% : 1사분위값
> 
> 50% : 2사분위값(중위값)
> 
> 75% : 3사분위값
>
> max : 최대값


**결측치(Missing Value)**

데이터에 값이 없는 것

> N/A : Not Available(dose not exist)
> 
> Null : empty(null) object
>
> NaN : Not a Number(python)

0은 숫자(값)0임. 결측치 아님.

데이터 분석 시 결측치는 반드시 처리해야 한다

왜?

모델은 결측치 이해 못함 -> 모델 성능 하락이나 에러 발생 가능

결측치 처리는 고성능 ai 모델 제작에 중요 요소. 

추가적 조사나 통상적 방법으로 처리 -> 물리적으로 처리 불가능한 경우 적당히 한다?


**결측치 처리 특징**

1.	실무자 견해가 많이 반영되는 단계

같은 데이터도 실무자 의견에 따라 결과 바뀔 수 있음. 임의대로 결측치 처리 시 분석결과 

크게 틀어질수도. 데이터 실무자와의 많은 협의 필수.

2.	시간이 많이 투자되어야 함

데이터 양이 많고, 결측치 비율이 높을 수록 더욱 데이터 현실을 반영한 결측치 처리가 되어야 한다. 
그럴 수록 시간이 많이 든다. 그래도 시간 투자만큼 데이터 정확도가 오르기 때문에 시간투자가 필수.

3.	결측치 제거는 가장 손쉬운 처리법

그러나, 막대한 데이터 손실을 동반하는 방법

4.	결측치를 단순 대체할 시엔?

데이터에서 편향(bias)이 생길 수 있다.


**결측치 처리 방법**

1.	제거하기

**Listwise** 방식 : 결측치가 존재하는 전체 행(레코드)을 삭제한다.

-> 하나의 행에 한 컬럼이라도 *결측치가 존재하면 해당 행 삭제*.

-> 최대치의 정보 손실 발생

**Parewise** 방식 : *모든 변수가 결측치인 경우* 해당 행을 삭제.

-> 그 외 결측치는 데이터 분석에서 무시됨.

-> 정확한 데이터 분석이나 최적 모델 생성에 악영향.

어느 쪽이든 필연적으로 데이터 손실 발생.

2.	채우기

**값 대체하기** : 결측치를 평균화 값으로 대체

-> 평균화 값으로는 ‘평균(mean)’, ‘중앙값(median)’, ‘최빈값(mode)’이 주로 사용

**예측하기** : 결측치를 상관관계 등을 예측하여 대체

-> 상관관계 혹은 예측모델 사용.

장점 : 결측치를 정보 손실 없이 빠르게 채울 수 있다.

단점 : 모든 결측치가 동일 값 가질 수 있다. - 데이터 편향 틀어질 수 있음

    아니더라도, 채워진 값에 의해 평균/중앙값/상관관계 등이 영향받을수도


**실제 처리 예시**

> 결측치를 지정한 값으로 채우는 메소드
>```python
> Dataframe명.fillna(‘standard’)
>```
> N/A 란을 ‘standard’(주어진 값)으로 채우는 함수


> 결측치를 같은 간격으로 채우는 메소드
>```python
> Dataframe명.interpolate()
>```
> 연속형 값의 중간값(앞, 뒤 레코드 값의) 채워줌.
>
> 범주형 데이터에 적용 불가(범주형 데이터는 최빈값 이용 권장)


> 결측치가 있는 레코드를 제거하는 메소드
>```python
> Dataframe명.dropna()
>```
> likewise 방식. 
>```python
> Dataframe명.dropna(how=’all’) : pariwise 방식
>```


### 데이터전처리 - 이상치 처리, Feature Engineering

이상치 : 특정 추세를 크게 벗어난 데이터. 중앙값을 크게 벗어난 데이터
 

**Feature Engineering**

모델 정확도를 높이기 위해 주어진 데이터를 잘 표현할 수 있는 features로 변형시키는 과정이며, 데이터의 도메인 지식을 활용해 feature를 만드는 과정

Feature : 각 데이터의 특징


Data gathering(데이터 수집) -> Feature Engineering -> Modeling

데이터 수집을 마친 raw data를 퓨처엔지니어링 해서 training data로 만들어 사용


**Feature Engineering의 방법**


1.	연속형 범주 다루기

**Binning**

연속형 변수를 범주형 변수로 만드는 방법

연속형 변수를 적절히 그룹지으면 데이터 이해가 쉬워짐.

> 연속형 변수인 ‘나이’데이터를 범주형 변수 ‘연령대’로 그룹지어서 10대-20대-30대 …로 만든다.
>
> 연속형 변수인 ‘시험점수’데이터를 범주형 변수 ‘등급’으로 나눈다.


1. **cut**

원하는 길이로 구간 나누기. 사용자가 구간값을 직접 입력

> ex) 90-100 : A, 80-90 : B 와 같은 절대평가 성적 분류

2. **qcut**

  동일 개수로 구간 나누기. 사용자가 구간 개수를 입력

> ex) 1등급 5%, ... 와 같은 상대평가 성적 분류.



**Scaling**

숫자 데이터간의 상대적 크기 차이를 제거하는 방법

각 컬럼에 들어있는 데이터의 상대적 크기에 따라 분석이나 모델링 결과가 달라짐.

normalization formula(정규화 공식)

X = ( x-min(x) ) / ( max(x)-min(x) )

1. **StandardScaler()**

각 특성의 평균을 0, 분산을 1로 스케일링.

즉, 데이터를 정규분포로 만든다.

2. **MaxAbsScaler()** *최대 절대값 스케일러

각 특성의 절대값이 0과 1 사이가 되도록 스케일링한다.

즉, 모든 값은 -1과 1 사이로 표현된다.

*데이터가 양수일 경우 MinMaxScaler와 동일.


2.	범주형 변수 다루기

**Label Encoding**

범주형 변수의 문자열 값을 숫자로 매핑

컴퓨터에게 문자열(범주)을 이해하라고 요구하는 대신, 범주형 변수의 문자열 값을 각기 숫자로 변환하는 것.

> color 컬럼의 값은 red, green, blue다.
>
> red = 0, green = 1, blue = 2로 인코딩

**One Hot Encoding**

하나의 데이터만 1, 나머지는 0으로 만들어 주는 방법.

> color 컬럼의 값은 red, green, blue다.
>
> A행, B행, C행, D행이 있다.
>
> A행이 ‘red’일 경우, 1 0 0 (red green blue)
>
> B행이 ‘blue’일 경우, 0 0 1

하나의 컬럼이 여러개의 컬럼(범주의 값 수)으로 바뀌고, 그 중 하나만 1이며 나머지 컬럼은 0으로 채워짐.

**pd.get_dummies([범주 값들])**함수로 구현


3. 날짜 데이터 변형

>놀이동산 데이터가 ‘일자’, ‘방문객수’로 구성. 날짜 흐름에 따른 방문객수 증가 추세.

pd.to_datetime( cust[‘일자’] )

일반적인 0000-00-00 형태의 날짜 데이터(문자)를 데이터(숫자형 날짜)로 변환

cust[‘일자’].dt.dayofweek

숫자형 날짜 0000-00-00 을 요일(월=0, 화=1, 수=2, 목=3, 금=4, 토=5, 일=6)로 변환하는 메소드.


3. 기타

  **PCA 차원축소**

  다중차원 그래프보다 이해가 쉬운 2차원 그래프로 압축하여 표현

> 4개의 변수를 가진 ‘붓꽃 데이터’ IRIS를 가지고 한꺼번에 그래프를 표현할때
>
> 4차원 그래프로 표현하기 vs 차원을 축소해 2차원으로 표현하기
>
> 잎 길이, 잎 넓이, 꽃잎 길이, 꽃잎 넓이
>
> PCA 컴포넌트 1, 2를 x, y축으로. 아이콘에서 품종 구분.

2개의 주성분으로 많은 변동성을 반영.
